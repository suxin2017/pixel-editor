(this.webpackJsonpeditor=this.webpackJsonpeditor||[]).push([[0],{28:function(t,e,n){},29:function(t,e,n){},34:function(t,e,n){},35:function(t,e,n){},36:function(t,e,n){"use strict";n.r(e);var o=n(2),r=n.n(o),i=n(15),c=n.n(i),a=(n(28),n(29),n(4)),s=n(10),l=n(6),p=n(8),u=n(5),d=(n(19),n(0));function j(t,e){var n;e(t),null===(n=t.children)||void 0===n||n.forEach((function(t){j(t,e)}))}var v,b,h,m,f,O=n(16),g=n(3),y=n(7),x=n(22),C=function(t){for(var e,n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];(e=console).log.apply(e,["%c render:component-list %c".concat(t),"color:blue","color:black"].concat(o))},w=new Map,k=function(t){return C("get component %s",t),w.get(t)};!function(t){t.CONTAINER="container",t.ATOM="atom"}(f||(f={}));var A,P,T,E,N=(v=function(){function t(e){var n,o=this;Object(l.a)(this,t),this.id=void 0,Object(s.a)(this,"props",b,this),this.name=void 0,this.type=f.ATOM,Object(s.a)(this,"parent",h,this),Object(s.a)(this,"children",m,this),this.historyStack=void 0,Object(d.w)(this),this.name=e.name,this.children=e.children,this.children&&this.children.forEach((function(t){t.parent=o})),this.id=null!==(n=e.id)&&void 0!==n?n:Object(x.v4)(),this.props=Object(g.a)(Object(g.a)({},e.initProps),{},{$id:this.id}),console.log(e),e.type&&(this.type=e.type)}return Object(p.a)(t,[{key:"getRootStore",value:function(){return this.parent?this.parent.getRootStore():this}},{key:"getParent",value:function(){return this.parent}}]),t}(),b=Object(u.a)(v.prototype,"props",[d.x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(u.a)(v.prototype,"parent",[d.x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(u.a)(v.prototype,"children",[d.x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v),D=new Map,B=function(){D.clear(),C("clear all components %s"),w.clear()},I=function(t){return D.has(t.name)?D:(e=t.name,n={component:t.component,store:t.store},w.has(e)||(C("add component %s",e),w.set(e,n)),D.set(t.name,t));var e,n},R=function(t){return D.get(t)},S=n(23),z=[],H=[],M=-1,F=!1,L=new(function(){function t(){Object(l.a)(this,t)}return Object(p.a)(t,[{key:"init",value:function(){z.length=0,H.length=0,M=-1,F=!1}},{key:"push",value:function(t){if(!F){var e=H[M-1];if(Object(y.isEqual)(Object(d.C)(t),e))return;M++,z.length=M+1,H.length=M+1,z[M]=t,H[M]=Object(y.cloneDeep)(t),console.log("push hsitory =>",H,M)}}},{key:"dispatch",value:function(t,e){var n=z[t],o=H[t];console.log("dispatch",t,Object(d.C)(n),o),o&&(Object(y.isEqual)(Object(d.C)(n),o)?e():Object(y.keys)(o).forEach((function(t){console.log("key ".concat(t," => "),o[t]),n[t]=o[t]})))}},{key:"undo",value:function(){var t=this;M-1!==-1&&(F=!0,this.dispatch(--M,(function(){t.undo()})),F=!1)}},{key:"redo",value:function(){var t=this;F=!0,M+1>=z.length||(this.dispatch(++M,(function(){t.redo()})),F=!1)}}]),t}()),V=new Map,q=new(A=function(){function t(e){Object(l.a)(this,t),Object(s.a)(this,"component",P,this),Object(s.a)(this,"activeComponent",T,this),Object(d.w)(this),this.component=e}return Object(p.a)(t,[{key:"addComponent",value:function(t,e){var n=new e.store({name:e.name,initProps:e.initProps});L.push(n.props);var o,r=Object(S.a)(n.props,Object(y.throttle)((function(t,e,n){L.push(n)}),1e3,{trailing:!1}));(V.set(n.id,r),t)?(n.parent=t,t.children||(t.children=[]),null===(o=t.children)||void 0===o||o.push(n)):this.component=n;return n}},{key:"addComponentToRoot",value:function(t){return this.addComponent(this.component,t)}},{key:"addComponentToNearParentComponent",value:function(t){if(this.activeComponent){for(var e=this.activeComponent;e&&e.type!==f.CONTAINER;)e=e.parent;if(!e)throw new Error("The nearest parent container component was not found");return this.addComponent(e,t)}return this.addComponentToRoot(t)}},{key:"deleteComponent",value:function(t){if(this.component){var e,n,o,r=this.activeComponent;t&&(r=function(t,e){var n,o;return n="string"===typeof t?t:t.id,j(e,(function(t){t.id===n&&(o=t)})),o}(t,this.component));var i=null===(e=r)||void 0===e||null===(n=e.parent)||void 0===n||null===(o=n.children)||void 0===o?void 0:o.indexOf(r);if(null!=r&&null!=i){var c,a;null===(c=r.parent)||void 0===c||null===(a=c.children)||void 0===a||a.splice(i,1);var s=V.get(r.id);s&&s(),V.delete(r.id)}else console.warn("no component delete")}}},{key:"getActiveComponent",value:function(){return this.activeComponent}},{key:"getActiveSetting",value:function(){var t;if(this.activeComponent)return null===(t=R(this.activeComponent.name))||void 0===t?void 0:t.settingComponent}},{key:"findComponentById",value:function(t){var e;return this.component&&j(this.component,(function(n){t===n.id&&(e=n)})),e}},{key:"moveComponent",value:function(t,e,n){var o,r,i,c,a=this.findComponentById(t);a&&(null===(o=a.parent)||void 0===o||null===(r=o.children)||void 0===r||r.splice(n,0,a),null===a||void 0===a||null===(i=a.parent)||void 0===i||null===(c=i.children)||void 0===c||c.splice(e,1))}},{key:"setActiveComponentById",value:function(t){var e=this.findComponentById(t);e&&(this.activeComponent=e)}},{key:"restInitState",value:function(){this.component=void 0,L.init()}}]),t}(),P=Object(u.a)(A.prototype,"component",[d.x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=Object(u.a)(A.prototype,"activeComponent",[d.x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(u.a)(A.prototype,"addComponent",[d.g],Object.getOwnPropertyDescriptor(A.prototype,"addComponent"),A.prototype),Object(u.a)(A.prototype,"addComponentToRoot",[d.g],Object.getOwnPropertyDescriptor(A.prototype,"addComponentToRoot"),A.prototype),Object(u.a)(A.prototype,"addComponentToNearParentComponent",[d.g],Object.getOwnPropertyDescriptor(A.prototype,"addComponentToNearParentComponent"),A.prototype),Object(u.a)(A.prototype,"deleteComponent",[d.g],Object.getOwnPropertyDescriptor(A.prototype,"deleteComponent"),A.prototype),Object(u.a)(A.prototype,"moveComponent",[d.g],Object.getOwnPropertyDescriptor(A.prototype,"moveComponent"),A.prototype),Object(u.a)(A.prototype,"setActiveComponentById",[d.g],Object.getOwnPropertyDescriptor(A.prototype,"setActiveComponentById"),A.prototype),A),J=r.a.createContext(q),W=J.Provider,_=function(){return r.a.useContext(J)},Y=n(11),$=n(12),G=n.n($),K=n(1),Q=function(t){return Object(K.jsx)("button",Object(g.a)(Object(g.a)({},t),{},{type:t.htmlType,className:G()("nes-btn",Object(Y.a)({},"is-".concat(t.type),!0)),children:t.children}))},U=function(t){return"nes-"+t},X=(n(34),function(t){return Object(K.jsx)("div",{className:G()(U("col"),t.span&&Object(Y.a)({},U("col-".concat(t.span)),!0)),style:Object(g.a)(Object(g.a)({},t.style),{},{flex:t.flex}),children:t.children})}),Z=(n(35),["gutter","wrapper","justify"]),tt=function(t){var e=t.children;t.gutter&&(e=r.a.Children.map(t.children,(function(e){var n,o,i,c,a;return r.a.cloneElement(e,Object(g.a)(Object(g.a)({},e.props),{},{style:Object(g.a)(Object(g.a)({},null===(n=e.props)||void 0===n?void 0:n.style),{},{paddingLeft:"number"===typeof t.gutter?t.gutter:null===(o=t.gutter)||void 0===o?void 0:o[0],paddingRight:"number"===typeof t.gutter?t.gutter:null===(i=t.gutter)||void 0===i?void 0:i[0],paddingTop:"number"===typeof t.gutter||null===(c=t.gutter)||void 0===c?void 0:c[1],paddingBottom:"number"===typeof t.gutter||null===(a=t.gutter)||void 0===a?void 0:a[1]})}))})));var n=t.gutter?{marginLeft:Array.isArray(t.gutter)?-t.gutter[0]:-t.gutter,marginRight:Array.isArray(t.gutter)?-t.gutter[0]:-t.gutter,marginTop:Array.isArray(t.gutter)?-t.gutter[1]:void 0,marginBottom:Array.isArray(t.gutter)?-t.gutter[1]:void 0}:void 0,o=(t.gutter,t.wrapper,t.justify,Object(O.a)(t,Z));return Object(K.jsx)("div",Object(g.a)(Object(g.a)({},o),{},{className:G()(U("row")),style:Object(g.a)(Object(g.a)(Object(g.a)({},n),o.style),{},{flexWrap:t.wrapper?"wrap":"nowrap",justifyContent:t.justify}),children:e}))},et=n(9),nt=n(14),ot=n(13),rt=(E=function(t){Object(nt.a)(n,t);var e=Object(ot.a)(n);function n(t){var o;return Object(l.a)(this,n),o=e.call(this,t),Object(d.w)(Object(et.a)(o)),o}return Object(p.a)(n,[{key:"setValue",value:function(t){this.props.value=t}}]),n}(N),Object(u.a)(E.prototype,"setValue",[d.g],Object.getOwnPropertyDescriptor(E.prototype,"setValue"),E.prototype),E),it=function(t){var e,n=t.props;t.store;return Object(K.jsxs)(tt,{gutter:[0,8],wrapper:!0,children:[Object(K.jsxs)(X,{span:12,children:[Object(K.jsx)("span",{children:"\u5185\u5bb9\uff1a"}),Object(K.jsx)("input",{value:n.value,onChange:function(t){n.value=t.target.value}})]}),Object(K.jsxs)(X,{span:12,children:[Object(K.jsx)("span",{children:"\u80cc\u666f\u989c\u8272 :"}),Object(K.jsx)("input",{type:"color",value:null===(e=n.style)||void 0===e?void 0:e.background,onChange:function(t){console.log(n.style),n.style&&(n.style.background=t.target.value)}})]})]})},ct=it=Object(a.a)(it),at=function(t){var e=t.props;t.children,t.store;return Object(K.jsx)("div",{style:{textAlign:"center"},children:Object(K.jsx)(Q,{style:Object(g.a)({},e.style),onClick:function(){console.log("download app")},children:e.value})})};at=Object(a.a)(at);var st={name:"button",icon:Object(K.jsx)("img",{src:"https://img.icons8.com/ios/50/000000/button2.png",alt:"ignore"}),store:rt,component:at,initProps:{value:"\u7acb\u5373\u4e0b\u8f7d",style:{background:"#fff"}},settingComponent:ct},lt=function(t){Object(nt.a)(n,t);var e=Object(ot.a)(n);function n(t){var o;return Object(l.a)(this,n),o=e.call(this,Object(g.a)(Object(g.a)({},t),{},{type:f.CONTAINER})),Object(d.w)(Object(et.a)(o)),o}return n}(N),pt=function(t){var e=t.props;return console.log(e),Object(K.jsx)("div",{children:"please select a component"})},ut=function(t){t.props;var e=t.children;t.store;return Object(K.jsx)("div",{style:{padding:24},children:e})};ut=Object(a.a)(ut);var dt={name:"container",icon:Object(K.jsx)("img",{src:"https://img.icons8.com/ios/50/000000/box--v1.png",alt:"icon"}),store:lt,component:ut,initProps:{value:""},settingComponent:pt},jt=function(t){Object(nt.a)(n,t);var e=Object(ot.a)(n);function n(t){var o;return Object(l.a)(this,n),o=e.call(this,t),Object(d.w)(Object(et.a)(o)),o}return n}(N),vt=function(t){var e=t.props;t.store;return Object(K.jsxs)("div",{children:[Object(K.jsx)("span",{children:"\u56fe\u7247\u94fe\u63a5 :"}),Object(K.jsx)("input",{value:e.src,onChange:function(t){e.src=t.target.value}})]})},bt=vt=Object(a.a)(vt),ht=function(t){var e=t.props;t.children,t.store;return Object(K.jsx)("div",{onClick:function(t){},children:Object(K.jsx)("img",{width:"100%",src:e.src,alt:"img"})})};ht=Object(a.a)(ht);var mt={name:"image",icon:Object(K.jsx)("img",{src:"https://img.icons8.com/dotty/80/000000/image--v1.png",alt:"icon",width:64}),store:jt,component:ht,initProps:{src:"https://img.88icon.com/download/jpg/20200819/2210309e15cb8b01fe45b3739e015cf7_512_398.jpg!88con"},settingComponent:bt},ft=function(t){var e,n,o=t.component,r=null===(e=k(o.name))||void 0===e?void 0:e.component;return r?Object(K.jsx)(r,{props:o.props,store:o,children:null===(n=o.children)||void 0===n?void 0:n.map((function(t){return Object(K.jsx)(ft,{component:t},t.id)}))}):(console.debug("component not found"),null)};ft=Object(a.a)(ft);var Ot;var gt,yt=((null===(gt={beforeHoc:function(){B(),I(dt),I(st),I(mt)},afterHoc:function(){q.restInitState();var t=q.addComponentToRoot(dt);console.log(t),q.activeComponent=t},hoc:[function(t){return Object(a.a)((function(e){var n,o,r=_(),i=(null===r||void 0===r||null===(n=r.activeComponent)||void 0===n?void 0:n.id)===e.store.id;return Object(K.jsxs)("div",{"data-name":"active wrapper",style:i?{border:"1px solid red",position:"relative"}:{position:"relative"},onClick:function(t){t.stopPropagation(),r&&(r.activeComponent=e.store)},children:[i&&Object(K.jsxs)("span",{style:{position:"absolute",right:0,fontSize:12},children:["active component ",null===(o=r.activeComponent)||void 0===o?void 0:o.name]}),Object(K.jsx)(t,{props:e.props,store:e.store,children:e.children})]})}))},function(t){return Object(a.a)((function(e){var n=function(t){var e=_();return{onDrag:function(t){t.preventDefault()},onDragEnd:function(t){t.preventDefault(),t.stopPropagation();var n=Ot,o=t.currentTarget;if(Ot!==o&&Ot.parentNode===o.parentNode){var r=Array.from(o.parentElement.children).indexOf(o),i=Array.from(n.parentElement.children).indexOf(n),c=Ot.dataset.id;c&&e.moveComponent(c,i,r)}},onDragEnter:function(t){t.stopPropagation()},onDragOver:Object(y.throttle)((function(t){t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect="move";var e,n,o=t.currentTarget,r=o.getBoundingClientRect(),i=r.top,c=r.height;Ot!==o&&Ot.parentNode===o.parentNode&&(t.pageY-i<=c/2?null===(e=o.parentNode)||void 0===e||e.insertBefore(Ot,o):o.nextElementSibling?null===(n=o.parentElement)||void 0===n||n.insertBefore(Ot,o.nextElementSibling):o.parentElement.appendChild(Ot))}),200,{trailing:!1}),onDragStart:function(t){t.stopPropagation();var n=t.currentTarget,o=n.dataset.id;o&&e.setActiveComponentById(o),Ot=n}}}();return Object(K.jsx)("div",Object(g.a)(Object(g.a)({"data-id":e.store.id,"data-type":e.store.type,draggable:!0},n),{},{children:Object(K.jsx)(t,{props:e.props,store:e.store,children:e.children})}))}))}]})||void 0===gt?void 0:gt.beforeHoc)&&gt.beforeHoc(),console.log(w),(null===gt||void 0===gt?void 0:gt.hoc)&&w.forEach((function(t,e){var n,o=null===(n=gt.hoc)||void 0===n?void 0:n.reduce((function(t,e){return e(t)}),t.component);if(!o)throw Error("component lose ");w.set(e,{store:t.store,component:o})})),(null===gt||void 0===gt?void 0:gt.afterHoc)&&gt.afterHoc(),ft),xt=function(){var t=_();return Object(K.jsxs)("div",{style:{position:"relative"},children:[Object(K.jsx)("div",{className:"nes-container with-title",style:{maxWidth:375,margin:"0 auto"},children:t.component&&Object(K.jsx)(yt,{component:t.component})}),Object(K.jsx)("div",{style:{position:"absolute",right:0,top:0},children:Object(K.jsxs)(tt,{gutter:[0,12],wrapper:!0,children:[Object(K.jsx)(X,{span:12,children:Object(K.jsx)(Q,{onClick:function(){t.deleteComponent()},children:"delete"})}),Object(K.jsx)(X,{span:12,children:Object(K.jsx)(Q,{onClick:function(){L.undo()},children:"undo"})}),Object(K.jsx)(X,{span:12,children:Object(K.jsx)(Q,{onClick:function(){L.redo()},children:"redo"})})]})})]})};xt=Object(a.a)(xt),console.log("update");var Ct=function(t){var e=_();return Object(K.jsxs)("div",{className:"nes-container with-title is-centered",children:["Components",(console.log(D.values()),Array.from(D.values())).map((function(t){return Object(K.jsxs)(tt,{wrapper:!0,justify:"center",onClick:function(){e.addComponentToNearParentComponent(R(t.name))},children:[Object(K.jsx)(X,{span:12,children:t.icon}),Object(K.jsx)(X,{span:12,style:{textAlign:"center"},flex:1,children:t.name})]})}))]})},wt=function(t){var e,n=_(),o=n.getActiveSetting();return console.log(o),Object(K.jsxs)("div",{className:"nes-container with-title",children:["setting",n.activeComponent&&o&&Object(K.jsx)(o,{props:null===(e=n.activeComponent)||void 0===e?void 0:e.props,store:n.activeComponent})]})};wt=Object(a.a)(wt);var kt=function(t){return Object(K.jsx)(W,{value:q,children:Object(K.jsxs)(tt,{gutter:24,style:{marginTop:64,padding:"24px"},children:[Object(K.jsx)(X,{span:1,children:Object(K.jsx)(Ct,{})}),Object(K.jsx)(X,{flex:1,children:Object(K.jsx)(xt,{})}),Object(K.jsx)(X,{span:3,children:Object(K.jsx)(wt,{})})]})})};var At=function(){return Object(K.jsx)("div",{className:"App",children:Object(K.jsx)(kt,{})})},Pt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(e){var n=e.getCLS,o=e.getFID,r=e.getFCP,i=e.getLCP,c=e.getTTFB;n(t),o(t),r(t),i(t),c(t)}))};c.a.render(Object(K.jsx)(r.a.StrictMode,{children:Object(K.jsx)(At,{})}),document.getElementById("root")),Pt()}},[[36,1,2]]]);
//# sourceMappingURL=main.c01cfcfa.chunk.js.map